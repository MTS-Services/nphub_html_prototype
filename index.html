<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>NP Clinical Hub - Login</title>
    <style>
    :root {
      --color-primary: #0A2540;
      --color-secondary: #FFD700;
      --color-bg: #ECECEC;
      --color-text: #2D2D2D;
      --border-radius: 10px;
      --transition: 0.3s ease;
    }
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: var(--color-bg);
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 20px;
    }
    .login-container {
      background: #fff;
      border-radius: 20px;
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
      overflow: hidden;
      width: 100%;
      max-width: 420px;
      animation: slideUp 0.6s ease-out;
    }
    @keyframes slideUp {
      from { opacity: 0; transform: translateY(30px);}
      to { opacity: 1; transform: translateY(0);}
    }
    .login-header {
      background: linear-gradient(135deg, var(--color-primary) 0%, var(--color-secondary) 100%);
      color: #fff;
      padding: 40px 30px;
      text-align: center;
    }
    .login-header h1 { font-size: 28px; font-weight: 600; margin-bottom: 8px; }
    .login-header p { opacity: 0.9; font-size: 16px; }
    .login-form { padding: 40px 30px; }
    .form-group { margin-bottom: 25px; }
    .form-group label {
      display: block; margin-bottom: 8px; font-weight: 500; color: var(--color-text); font-size: 14px;
    }
    .form-group input, .form-group select {
      width: 100%; padding: 15px; border: 2px solid #ccc; border-radius: var(--border-radius);
      font-size: 16px; transition: border-color var(--transition), background var(--transition);
      background: #f8f9fa; color: var(--color-text);
    }
    .form-group input:focus, .form-group select:focus {
      outline: none; border-color: var(--color-primary); background: #fff;
      box-shadow: 0 0 0 3px rgba(10, 37, 64, 0.1);
    }
    .login-btn {
      width: 100%; padding: 15px;
      background: linear-gradient(135deg, var(--color-primary) 0%, var(--color-secondary) 100%);
      color: #fff; border: none; border-radius: var(--border-radius);
      font-size: 16px; font-weight: 600; cursor: pointer;
      transition: transform var(--transition), box-shadow var(--transition);
      margin-bottom: 20px;
    }
    .login-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 20px rgba(10, 37, 64, 0.3);
    }
    .demo-section { border-top: 1px solid #ddd; padding-top: 25px; }
    .demo-title { text-align: center; color: #666; font-size: 14px; margin-bottom: 20px; font-weight: 500; }
    .demo-buttons {
      display: grid; grid-template-columns: 1fr 1fr; gap: 10px;
    }
    .demo-btn {
      position: relative;
      padding: 12px 16px; border: 2px solid #ccc; background: #fff;
      border-radius: var(--border-radius); cursor: pointer;
      transition: border-color var(--transition), background var(--transition), transform var(--transition);
      font-size: 13px; font-weight: 500; text-align: center; color: var(--color-text);
      outline: none;
    }
    .demo-btn:hover { border-color: var(--color-primary); background: #f0f0f0; transform: translateY(-1px);}
    .demo-btn.student, .demo-btn.jobseeker, .demo-btn.admin, .demo-btn.institution,
    .demo-btn.clinic, .demo-btn.preceptor, .demo-btn.mdcollaborator, .demo-btn.superadmin {
      border-color: var(--color-primary); color: var(--color-primary);
    }
    .demo-btn.student:hover, .demo-btn.jobseeker:hover, .demo-btn.admin:hover,
    .demo-btn.institution:hover, .demo-btn.clinic:hover, .demo-btn.preceptor:hover,
    .demo-btn.mdcollaborator:hover, .demo-btn.superadmin:hover { background: #f0f0f0; }
    .demo-btn:focus .tooltip,
    .demo-btn:hover .tooltip {
      opacity: 1;
      pointer-events: auto;
      transform: translateY(-8px) scale(1);
    }
    .tooltip {
      opacity: 0;
      pointer-events: none;
      position: absolute;
      left: 50%;
      bottom: 110%;
      transform: translateX(-50%) scale(0.98);
      background: var(--color-primary);
      color: #fff;
      padding: 8px 14px;
      border-radius: 6px;
      font-size: 12px;
      white-space: pre-line;
      box-shadow: 0 4px 16px rgba(10,37,64,0.13);
      z-index: 10;
      transition: opacity 0.2s, transform 0.2s;
      min-width: 140px;
      text-align: center;
    }
    .tooltip::after {
      content: '';
      position: absolute;
      top: 100%;
      left: 50%;
      transform: translateX(-50%);
      border-width: 6px;
      border-style: solid;
      border-color: var(--color-primary) transparent transparent transparent;
    }
    .error-message {
      background: #ffe6e6; color: #900; padding: 12px; border-radius: var(--border-radius);
      margin-bottom: 20px; font-size: 14px; display: none;
    }
    .show-password { display: flex; align-items: center; margin-top: 8px; font-size: 13px; color: var(--color-text);}
    .show-password input { width: auto; margin-right: 6px; }
    .register-link { text-align: center; margin-top: 20px; font-size: 14px; }
    .register-link a { color: var(--color-secondary); text-decoration: none; font-weight: 500; }
    @media (max-width: 480px) {
      .login-container { margin: 10px; max-width: 380px; }
      .login-header { padding: 30px 20px; }
      .login-form { padding: 30px 20px; }
      .demo-buttons { grid-template-columns: 1fr; }
      .demo-btn { font-size: 14px; }
      .tooltip { min-width: 120px; }
    }
    </style>
</head>
<body>
    <div class="login-container">
    <div class="login-header">
      <h1>NP Clinical Hub</h1>
      <p>Streamlined Clinical Management</p>
    </div>
    <div class="login-form">
      <div class="error-message" id="errorMessage"></div>
      <form id="loginForm">
        <div class="form-group">
          <label for="userRole">Select Role</label>
          <select id="userRole" required>
            <option value="">Choose your role...</option>
            <option value="superadmin">Super Admin</option>
            <option value="student">Student</option>
            <option value="jobseeker">Job Seeker</option>
            <option value="admin">Administrator</option>
            <option value="institution">Institution</option>
            <option value="clinic">Clinic Staff</option>
            <option value="preceptor">Preceptor</option>
            <option value="mdcollaborator">MD Collaborator</option>
          </select>
        </div>
        <div class="form-group">
          <label for="email">Email Address</label>
          <input type="email" id="email" placeholder="Enter your email" required autocomplete="username">
        </div>
        <div class="form-group">
          <label for="password">Password</label>
          <input type="password" id="password" placeholder="Enter your password" required autocomplete="current-password">
          <div class="show-password">
            <input type="checkbox" id="showPassword">
            <label for="showPassword">Show Password</label>
          </div>
        </div>
        <button type="submit" class="login-btn">Sign In</button>
      </form>
      <div class="demo-section">
        <div class="demo-title">Quick Demo Access</div>
        <div class="demo-buttons">
          <div class="demo-btn superadmin" tabindex="0" onclick="demoLogin('superadmin')">
            üõ°Ô∏è Super Admin Demo
            <span class="tooltip">Platform owner: manage all tenants, users, billing, and global settings.</span>
          </div>
          <div class="demo-btn student" tabindex="0" onclick="demoLogin('student')">
            üë®‚Äçüéì Student Demo
            <span class="tooltip">Student: apply for rotations, log hours, view progress, and manage profile.</span>
          </div>
          <div class="demo-btn jobseeker" tabindex="0" onclick="demoLogin('jobseeker')">
            üîç Job Seeker Demo
            <span class="tooltip">Job Seeker: search and apply for NP jobs after graduation.</span>
          </div>
          <div class="demo-btn admin" tabindex="0" onclick="demoLogin('admin')">
            üë®‚Äçüíº Admin Demo
            <span class="tooltip">Tenant admin: manage users, rotations, and reports for your organization.</span>
          </div>
          <div class="demo-btn institution" tabindex="0" onclick="demoLogin('institution')">
            üè´ Institution Demo
            <span class="tooltip">Institution: oversee students, placements, and compliance for your school.</span>
          </div>
          <div class="demo-btn clinic" tabindex="0" onclick="demoLogin('clinic')">
            üè• Clinic Demo
            <span class="tooltip">Clinic: manage preceptors, student schedules, and site evaluations.</span>
          </div>
          <div class="demo-btn preceptor" tabindex="0" onclick="demoLogin('preceptor')">
            ü©∫ Preceptor Demo
            <span class="tooltip">Preceptor: supervise students, complete evaluations, and track hours.</span>
          </div>
          <div class="demo-btn mdcollaborator" tabindex="0" onclick="demoLogin('mdcollaborator')">
            ü©∫ MD Collaborator Demo
            <span class="tooltip">MD Collaborator: review and approve NP collaboration requests.</span>
          </div>
        </div>
      </div>
      <div class="register-link">
        New user? <a href="register.html">Register here</a>
      </div>
    </div>
    </div>

    <script type="module">
    import { auth } from './firebase-init.js';
    import { signInWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/11.10.0/firebase-auth.js";

    const demoCredentials = {
      superadmin: { email: 'superadmin@npclinicalhub.com', password: 'superadmin123' },
      student: { email: 'taylor.jones@student.edu', password: 'student123' },
      jobseeker: { email: 'jane.doe@jobseeker.com', password: 'jobseeker123' },
      admin: { email: 'admin@npclinical.edu', password: 'admin123' },
      institution: { email: 'contact@stateuniversity.edu', password: 'institution123' },
      clinic: { email: 'clinic@sunrise.com', password: 'clinic123' },
      preceptor: { email: 'dr.smith@preceptor.com', password: 'preceptor123' },
      mdcollaborator: { email: 'md.collaborator@npclinical.edu', password: 'mdcollab123' }
    };

    document.getElementById('showPassword').addEventListener('change', function() {
      document.getElementById('password').type = this.checked ? 'text' : 'password';
    });

    document.getElementById('loginForm').addEventListener('submit', async function(e) {
      e.preventDefault();
      const role = document.getElementById('userRole').value;
      const email = document.getElementById('email').value.trim();
      const password = document.getElementById('password').value;
      if (!role || !email || !password) {
        return showError('Please fill in all fields');
      }
      // Try demo login first
      const demo = demoCredentials[role];
      if (demo && demo.email === email && demo.password === password) {
        return login(role, email);
      }
      // Try Firebase Auth login for real users
      try {
        const userCredential = await signInWithEmailAndPassword(auth, email, password);
        // Optionally, you can fetch the user's role from Firestore here
        login(role, email); // You may want to fetch the real role from Firestore
      } catch (error) {
        if (error.code === 'auth/user-not-found' || error.code === 'auth/wrong-password') {
          showError('Invalid email or password.');
        } else if (error.code === 'auth/user-disabled') {
          showError('This account has been disabled.');
        } else if (error.code === 'auth/too-many-requests') {
          showError('Too many failed attempts. Please try again later.');
        } else if (error.code === 'auth/invalid-email') {
          showError('Invalid email address.');
        } else {
          showError(error.message);
        }
      }
    });

    window.demoLogin = function(role) {
      const demo = demoCredentials[role];
      document.getElementById('userRole').value = role;
      document.getElementById('email').value = demo.email;
      document.getElementById('password').value = demo.password;
      setTimeout(() => login(role, demo.email), 500);
    };

    function login(role, email) {
      localStorage.setItem('userRole', role);
      localStorage.setItem('userEmail', email);
      localStorage.setItem('loginTime', new Date().toISOString());
      const dashboards = {
        superadmin: 'super-admin-dashboard.html',
        student: 'student-dashboard.html',
        jobseeker: 'job-seeker-dashboard.html',
        admin: 'admin-dashboard.html',
        institution: 'institution-dashboard.html',
        clinic: 'clinic-dashboard.html',
        preceptor: 'preceptor-dashboard.html',
        mdcollaborator: 'md-partnership-dashboard.html'
      };
      window.location.href = dashboards[role] || 'dashboard.html';
    }

    function showError(msg) {
      const err = document.getElementById('errorMessage');
      err.textContent = msg;
      err.style.display = 'block';
      setTimeout(() => err.style.display = 'none', 5000);
    }
    </script>
</body>
</html>